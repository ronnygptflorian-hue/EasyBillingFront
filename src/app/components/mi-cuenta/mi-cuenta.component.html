<app-loading *ngIf="loading"></app-loading>

<div class="mi-cuenta-container">
  <div class="page-header">
    <h1>Mi Cuenta</h1>
    <p>Gestiona tu informaciÃ³n personal y configuraciÃ³n de seguridad</p>
  </div>

  <div class="account-content">
    <div class="account-section">
      <div class="section-header">
        <h2>InformaciÃ³n Personal</h2>
      </div>
      <div class="info-card">
        <div class="info-row">
          <label>Nombre</label>
          <span class="info-value">{{ userData?.nombre || 'N/A' }}</span>
        </div>
        <div class="info-row">
          <label>Usuario</label>
          <span class="info-value">{{ userData?.loginName || 'N/A' }}</span>
        </div>
        <div class="info-row">
          <label>Tipo de Usuario</label>
          <span class="info-value badge" [ngClass]="{
            'badge-admin': userData?.tipo === 'A',
            'badge-user': userData?.tipo === 'U'
          }">
            {{ userData?.tipo === 'A' ? 'Administrador' : 'Usuario' }}
          </span>
        </div>
        <div class="info-row">
          <label>Ãšltima SesiÃ³n</label>
          <span class="info-value">{{ userData?.fechaLogin | date: 'dd/MM/yyyy HH:mm' }}</span>
        </div>
      </div>
    </div>

    <div class="account-section">
      <div class="section-header">
        <h2>Cambiar ContraseÃ±a</h2>
        <p class="section-description">Actualiza tu contraseÃ±a para mantener tu cuenta segura</p>
      </div>

      <div class="form-card">
        <form [formGroup]="changePasswordForm" (ngSubmit)="onSubmitChangePassword()">
          <div class="form-group">
            <label for="oldPassword">ContraseÃ±a Actual *</label>
            <div class="password-input-wrapper">
              <input
                [type]="showOldPassword ? 'text' : 'password'"
                id="oldPassword"
                formControlName="oldPassword"
                placeholder="Ingresa tu contraseÃ±a actual"
                class="form-input"
              />
              <button
                type="button"
                class="toggle-password"
                (click)="togglePasswordVisibility('old')"
              >
                {{ showOldPassword ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
              </button>
            </div>
          </div>

          <div class="form-group">
            <label for="newPassword">Nueva ContraseÃ±a *</label>
            <div class="password-input-wrapper">
              <input
                [type]="showNewPassword ? 'text' : 'password'"
                id="newPassword"
                formControlName="newPassword"
                placeholder="MÃ­nimo 6 caracteres"
                class="form-input"
              />
              <button
                type="button"
                class="toggle-password"
                (click)="togglePasswordVisibility('new')"
              >
                {{ showNewPassword ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
              </button>
            </div>
            <small class="form-hint">La contraseÃ±a debe tener al menos 6 caracteres</small>
          </div>

          <div class="form-group">
            <label for="confirmPassword">Confirmar Nueva ContraseÃ±a *</label>
            <div class="password-input-wrapper">
              <input
                [type]="showConfirmPassword ? 'text' : 'password'"
                id="confirmPassword"
                formControlName="confirmPassword"
                placeholder="Repite la nueva contraseÃ±a"
                class="form-input"
              />
              <button
                type="button"
                class="toggle-password"
                (click)="togglePasswordVisibility('confirm')"
              >
                {{ showConfirmPassword ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
              </button>
            </div>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn-primary" [disabled]="loading || changePasswordForm.invalid">
              {{ loading ? 'Cambiando...' : 'Cambiar ContraseÃ±a' }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
